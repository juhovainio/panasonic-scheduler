TODO:
- Add error logging
- Add support for reading messages